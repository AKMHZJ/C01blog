<article (click)="cardClick.emit()" class="blog-card font-sans">
  
  <!-- 1. Thumbnail Image (4:3, sharp) -->
  <div class="image-container">
    <ng-container *ngIf="isVideo(image); else imgTemplate">
      <video [src]="image | imageUrl" class="card-image object-cover" muted loop onmouseover="this.play()" onmouseout="this.pause()"></video>
      <div class="video-indicator absolute top-2 right-2 bg-black/60 text-white rounded-full p-1 backdrop-blur-sm">
        <mat-icon style="font-size: 16px; width: 16px; height: 16px;">play_arrow</mat-icon>
      </div>
    </ng-container>
    <ng-template #imgTemplate>
      <img [src]="image | imageUrl:'https://placehold.co/600x400'" [alt]="title" class="card-image" />
    </ng-template>
  </div>

  <!-- 2. Meta Row (Badge + Date) -->
  <div class="meta-row">
    <span class="category-badge" [style.background]="hidden ? '#ef4444' : ''">{{ hidden ? 'HIDDEN' : category }}</span>
    <span class="date-text">{{ date | date }}</span>
  </div>

  <!-- 3. Title -->
  <h3 class="card-title" [title]="title">{{ title }}</h3>

  <!-- Stats Row (Likes and Comments) -->
  <div class="stats-row" *ngIf="likeCount > 0 || commentCount > 0">
    <div class="stat-item" *ngIf="likeCount > 0">
      <mat-icon style="font-size: 14px; width: 14px; height: 14px; color: #ef4444;">favorite</mat-icon>
      <span>{{ likeCount }}</span>
    </div>
    <div class="stat-item" *ngIf="commentCount > 0">
      <mat-icon style="font-size: 14px; width: 14px; height: 14px;">chat_bubble_outline</mat-icon>
      <span>{{ commentCount }}</span>
    </div>
  </div>

  <!-- 4. Author Row -->
  <div class="author-row">
    <img [src]="author?.avatar | imageUrl:'https://placehold.co/32'" class="author-avatar" />
    <span class="author-name">{{ author?.displayName || author?.username }}</span>
    
    <div class="spacer"></div>
    
    <!-- Keeping report button accessible but subtle/hidden until hover maybe? Or just aligned right as utility -->
    <button (click)="openReport($event)" class="report-btn" title="Report">
      <mat-icon style="font-size: 16px; width: 16px; height: 16px;">flag</mat-icon>
    </button>
  </div>

</article>
